import{r as u,u as R,P as T,C as B,a as U,I as k,c as _,b as $,d as I,e as L,f as O,j as s,D as A,U as G,B as P,g as H}from"./index-BEh_xnfq.js";import{u as q,D as K,C as f,I as y,P as J,a as Q}from"./Filters-zWTrT3pY.js";import{g as X,s as Y}from"./users-lp7Z4iIr.js";import{F as z}from"./FailedRequest-B3co_hjT.js";import"./inputnumber.esm-BpHC9-a_.js";function g(e){"@babel/helpers - typeof";return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(e)}function V(e,t){if(g(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(g(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W(e){var t=V(e,"string");return g(t)==="symbol"?t:String(t)}function S(e,t,n){return t=W(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z={value:"p-tag-value",icon:"p-tag-icon",root:function(t){var n=t.props;return _("p-tag p-component",S(S({},"p-tag-".concat(n.severity),n.severity!==null),"p-tag-rounded",n.rounded))}},ee=`
@layer primereact {
    .p-tag {
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    .p-tag-icon,
    .p-tag-value,
    .p-tag-icon.pi {
        line-height: 1.5;
    }
    
    .p-tag.p-tag-rounded {
        border-radius: 10rem;
    }
}
`,v=B.extend({defaultProps:{__TYPE:"Tag",value:null,severity:null,rounded:!1,icon:null,style:null,className:null,children:void 0},css:{classes:Z,styles:ee}});function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,o)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(o){S(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}var N=u.forwardRef(function(e,t){var n=R(),o=u.useContext(T),a=v.getProps(e,o),c=v.setMetaData({props:a}),p=c.ptm,d=c.cx,w=c.isUnstyled;U(v.css.styles,w,{name:"tag"});var m=u.useRef(null),l=n({className:d("icon")},p("icon")),b=k.getJSXIcon(a.icon,te({},l),{props:a});u.useImperativeHandle(t,function(){return{props:a,getElement:function(){return m.current}}});var x=n({ref:m,className:_(a.className,d("root")),style:a.style},v.getOtherProps(a),p("root")),j=n({className:d("value")},p("value"));return u.createElement("span",x,b,u.createElement("span",j,a.value),u.createElement("span",null,a.children))});N.displayName="Tag";function le(){const{response:e,error:t,loading:n,execute:o}=$("users/list",!1),[a,c]=u.useState({limit:10,page:0}),[p,d]=u.useState(!0),[w,m]=u.useState(null),{language:{users:l}}=I(),{can:b}=q(),x=X(),j=Y(),E=u.useCallback(L(o,300),[]);u.useEffect(()=>{const r={pagination:{limit:a.limit,page:a.page},filters:[{path:"username",value:a.username,operator:"$regex"},{path:"phoneNumber",value:a.phoneNumber,operator:"$regex"},{path:"email",value:a.email,operator:"$regex"},{path:"role",value:a.role,operator:"$regex"},{path:"status",value:a.status}]};E(`users/list?${O(r)}`);const i=h=>{h.origin===window.location.origin&&h.data.type==="USER_CHANGED"&&o(`users/list?${O(r)}`)};return window.addEventListener("message",i),()=>{window.removeEventListener("message",i)}},[a]);const D=r=>{const i=()=>{m(r)};return s.jsx("div",{className:"actions-con",children:b(H)&&s.jsx(P,{icon:"pi pi-pencil",rounded:!0,text:!0,onClick:()=>{i(),window.open(`/#/update-user?id=${r.id}`,"_blank","width=900,height=620")}})})},F=(r,i)=>{c(h=>({...h,[i]:r.target.value}))},M=r=>{c(i=>({...i,limit:r.rows,page:r.page}))};return s.jsx("div",{className:"datatable-filter-demo p-toolbar header-justify-between footer-justify-between",children:s.jsxs(K,{value:e==null?void 0:e.data,loading:n,emptyMessage:()=>t?s.jsx(z,{setFilters:c}):l.no_records,scrollable:!0,selectionMode:"single",selection:w,onSelectionChange:r=>m(r.value),filterDisplay:p?"row":void 0,header:s.jsxs(s.Fragment,{children:[b(G)&&s.jsx(P,{label:l.add_user,outlined:!0,icon:"pi pi-user-plus",onClick:()=>{window.open("/#/add-user","_blank","width=900,height=650")}}),s.jsx("div",{className:"show-filter-button-wrapper button-align-end",children:s.jsx(P,{icon:"pi pi-filter",severity:"secondary",text:!p,onClick:()=>d(r=>!r)})})]}),footer:s.jsx("div",{className:"table-footer",children:s.jsx(J,{className:"align-end",rows:a.limit,first:a.page*a.limit,totalRecords:e==null?void 0:e.meta.totalItems,onPageChange:r=>M(r),rowsPerPageOptions:[10,25,50,100],template:Q()})}),children:[s.jsx(f,{showFilterMenu:!1,showClearButton:!1,field:"phoneNumber",header:l.phone,filter:!0,body:r=>s.jsx("span",{dir:"auto",children:r.phoneNumber||l.unknown}),filterElement:s.jsx(y,{label:"phoneNumber",filters:a,setFilters:c})}),s.jsx(f,{showFilterMenu:!1,showClearButton:!1,field:"username",header:l.username,filter:!0,body:r=>s.jsxs("div",{children:[r.username," ",s.jsx(N,{className:"inline-tag contrast-tag",severity:"info",value:r.role||l.unknown})]}),filterMatchModeOptions:[],filterElement:s.jsxs("div",{className:"space-filter",children:[s.jsx(y,{label:"username",filters:a,setFilters:c}),s.jsx(y,{label:"role",filters:a,setFilters:c})]})}),s.jsx(f,{showFilterMenu:!1,showClearButton:!1,field:"email",header:l.email,filter:!0,filterElement:s.jsx(y,{label:"email",filters:a,setFilters:c}),body:r=>r.email||l.unknown}),s.jsx(f,{showFilterMenu:!1,showClearButton:!1,field:"status",header:l.status,filter:!0,body:({status:r})=>{let i;switch(r){case"مفعل":i="contrast-tag";break;case"معلق":i="yellow-tag";break;default:i="red-tag"}return s.jsx(N,{className:i,value:x[r]||r||l.unknown})},filterElement:s.jsx(A,{value:a.status,options:j,onChange:r=>F(r,"status"),placeholder:l.search_by_status,className:"dropdown-filter-element"})}),s.jsx(f,{showFilterMenu:!1,showClearButton:!1,filter:!0,className:"actions-col",body:r=>D(r),filterElement:s.jsx("div",{className:"actions-filter"})})]})})}export{le as default};
