import{r as y,d as O,H as R,b as q,aE as H,j as e,L as C,Y as l,x as i,a8 as x,G as P,B as v}from"./index-Ba1r5UNg.js";import{F as M}from"./FailedRequest-C5Hseg6-.js";import{s as j}from"./invoices.module-D0SLCOUJ.js";import{I as S}from"./inputnumber.esm-B_oH-kEB.js";function T(){const[s,p]=y.useState(),{language:{invoices:{update_invoice_page:a}}}=O(),[$]=R(),g=$.get("id"),{response:h,loading:N,execute:_,error:E,loaded:L}=q(`invoices/detail/${g}`),{handleUpdateInvoice:m,loading:b}=H(g,_);if(y.useEffect(()=>{h&&p(h.data)},[h]),E)return e.jsx("div",{className:"external-page-wra",children:e.jsx(M,{action:_})});if(!L&&N||!s)return e.jsx(C,{});const t=s.pharmacist;return e.jsxs(e.Fragment,{children:[N&&e.jsx(C,{}),e.jsx("div",{className:"external-page-wra",children:e.jsxs("div",{className:"external-page",children:[e.jsx("h2",{className:"header",children:a.invoice_info}),e.jsxs("div",{className:"input-fields float-labels",children:[e.jsx("span",{className:j.subtitle,children:a.brief}),e.jsxs("div",{className:"two-fields",children:[e.jsxs(l,{children:[e.jsx(i,{value:t.fullName,disabled:!0}),e.jsx("label",{children:a.full_name})]}),e.jsxs(l,{children:[e.jsx(i,{value:t.graduationYear?new Date(t.graduationYear).getFullYear().toString():"",disabled:!0}),e.jsx("label",{children:a.graduation_year})]})]}),e.jsxs("div",{className:"two-fields",children:[e.jsxs(l,{children:[e.jsx(i,{value:t.birthDate?x(t.birthDate):"",disabled:!0}),e.jsx("label",{children:a.birth_date})]}),e.jsxs(l,{children:[e.jsx(i,{value:t.lastTimePaid?x(t.lastTimePaid):"",disabled:!0}),e.jsx("label",{children:a.last_time_paid})]})]}),e.jsxs("div",{className:"two-fields",children:[e.jsxs(l,{children:[e.jsx(i,{value:s.syndicateMembership,disabled:!0}),e.jsx("label",{children:a.syndicate_membership})]}),e.jsxs(l,{children:[e.jsx(i,{value:s.createdAt?x(s.createdAt):"",disabled:!0}),e.jsx("label",{children:a.created_at})]})]}),e.jsxs("div",{className:"two-fields",children:[e.jsxs(l,{children:[e.jsx(i,{value:s.paidDate?x(s.paidDate):"",disabled:!0}),e.jsx("label",{children:a.paid_date})]}),e.jsxs(l,{children:[e.jsx(S,{value:s.total,disabled:!0}),e.jsx("label",{children:a.total})]})]}),e.jsxs(l,{children:[e.jsx(i,{value:s.status,disabled:!0}),e.jsx("label",{children:a.invoice_status})]}),e.jsx(P,{}),s.fees&&Object.entries(s.fees).map(([d,Y])=>{const{fees:F}=Y,D=[];for(let r=0;r<F.length;r+=2)D.push(F.slice(r,r+2));return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:j.subtitle,children:[d," :"]}),D.map((r,w)=>e.jsx("div",{className:"two-fields",children:r.map((I,k)=>{const c=w*2+k,B=f=>{p(u=>{if(!u)return u;const n={...u.fees};if(n&&n[d]){const o=[...n[d].fees];o[c]={...o[c],value:f||0};const U=o.reduce((A,G)=>A+G.value,0);n[d]={fees:o,total:U}}return{...u,fees:n}})};return e.jsxs(l,{children:[e.jsx(S,{disabled:s.status!=="جاهزة لللإرسال",value:I.value,onChange:f=>B(f.value),min:0}),e.jsx("label",{htmlFor:`fee-${d}-${c}`,children:I.name})]},`${d}-${c}`)})},w))]})})]}),s.status==="جاهزة لللإرسال"&&e.jsxs(e.Fragment,{children:[e.jsx(P,{}),e.jsxs("div",{className:j.invoiceButtons,children:[e.jsxs("div",{children:[e.jsx(v,{label:a.cancelled,onClick:()=>{m("ملغاة")},outlined:!0,severity:"danger",disabled:b}),e.jsx(v,{label:a.paid,className:j.paid,onClick:()=>{m("مدفوع")},outlined:!0,disabled:b})]}),e.jsx(v,{onClick:()=>{s.fees&&m(s.fees)},label:a.update_invoice,disabled:b})]})]})]})})]})}export{T as default};
