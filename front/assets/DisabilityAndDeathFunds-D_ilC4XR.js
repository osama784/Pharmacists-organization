import{r,d as F,a3 as v,a4 as C,e as E,b as P,f as R,aN as A,g as u,j as a,aO as S,B as N,aR as O}from"./index-CAbGq19O.js";import{D as _,C as g,P as I,a as L,c as T}from"./Filters-BDT0_iG5.js";import{F as k}from"./FailedRequest-kw7mU4Mw.js";import{d as G}from"./accounting-B1riqVYz.js";function Q(){const[m,p]=r.useState(null),{language:{accounting:o}}=F(),b=v(),d=C(e=>e.disabilityAndDeathFunds.downloading),{can:f}=E(),{response:i,error:h,loading:y,execute:c}=P("reports/invoices",!1),[s,l]=r.useState({limit:10,page:0,section:"صندوق إعانة العجز و الوفاة"}),w=r.useCallback(R(c,300),[]);r.useEffect(()=>{const e=A(s);w(`reports/invoices?${u(e)}`);const t=n=>{n.origin===window.location.origin&&n.data.type==="INVOICE_CHANGED"&&c(`disabilityAndDeathFunds/list?${u(e)}`)};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},[s]);const x=e=>{l(t=>({...t,limit:e.rows,page:e.page}))},D=(e,t)=>{if(!e)return 0;const n=e.find(j=>j.name===t);return n!=null&&n.value?n.value:o.unknown};return a.jsx("div",{className:"datatable-filter-demo p-toolbar header-justify-between footer-justify-between",children:a.jsxs(_,{value:i==null?void 0:i.data,loading:y,emptyMessage:()=>h?a.jsx(k,{setFilters:l}):o.no_records,scrollable:!0,selectionMode:"single",selection:m,onSelectionChange:e=>p(e.value),header:a.jsx(T,{label:"createdAt",filters:s,setFilters:l}),footer:a.jsxs("div",{className:"table-footer",children:[f(S)&&a.jsx(N,{label:o.export,loading:d,text:!0,severity:"secondary",onClick:()=>{d||b(O(s))}}),a.jsx(I,{className:"align-end",rows:s.limit,first:s.page*s.limit,totalRecords:i==null?void 0:i.meta.totalItems,onPageChange:e=>x(e),rowsPerPageOptions:[10,25,50,100],template:L()})]}),children:[a.jsx(g,{field:"receiptNumber",header:o.receipt_number}),G.map(e=>a.jsx(g,{header:e,body:t=>a.jsx("span",{children:D(t.fees,e)})},e))]})})}export{Q as default};
