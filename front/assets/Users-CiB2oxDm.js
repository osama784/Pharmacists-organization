import{r as c,u as k,P as B,C as L,a as I,I as $,c as _,b as A,d as G,e as H,f as q,g as N,j as s,D as K,U as Q,B as w,h as J,i as X,k as Y}from"./index-CAbGq19O.js";import{D as z,C as g,I as j,P as V,a as W}from"./Filters-BDT0_iG5.js";import{u as Z,g as ee,s as te,a as re}from"./users-g8c1QTf5.js";import{F as se}from"./FailedRequest-kw7mU4Mw.js";function y(e){"@babel/helpers - typeof";return y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},y(e)}function ne(e,r){if(y(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(y(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function ae(e){var r=ne(e,"string");return y(r)==="symbol"?r:String(r)}function E(e,r,n){return r=ae(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}var oe={value:"p-tag-value",icon:"p-tag-icon",root:function(r){var n=r.props;return _("p-tag p-component",E(E({},"p-tag-".concat(n.severity),n.severity!==null),"p-tag-rounded",n.rounded))}},le=`
@layer primereact {
    .p-tag {
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    .p-tag-icon,
    .p-tag-value,
    .p-tag-icon.pi {
        line-height: 1.5;
    }
    
    .p-tag.p-tag-rounded {
        border-radius: 10rem;
    }
}
`,x=L.extend({defaultProps:{__TYPE:"Tag",value:null,severity:null,rounded:!1,icon:null,style:null,className:null,children:void 0},css:{classes:oe,styles:le}});function O(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,a)}return n}function ie(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?O(Object(n),!0).forEach(function(a){E(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}var S=c.forwardRef(function(e,r){var n=k(),a=c.useContext(B),u=x.getProps(e,a),m=x.setMetaData({props:u}),i=m.ptm,d=m.cx,b=m.isUnstyled;I(x.css.styles,b,{name:"tag"});var h=c.useRef(null),P=n({className:d("icon")},i("icon")),v=$.getJSXIcon(u.icon,ie({},P),{props:u});c.useImperativeHandle(r,function(){return{props:u,getElement:function(){return h.current}}});var o=n({ref:h,className:_(u.className,d("root")),style:u.style},x.getOtherProps(u),i("root")),f=n({className:d("value")},i("value"));return c.createElement("span",o,v,c.createElement("span",f,u.value),c.createElement("span",null,u.children))});S.displayName="Tag";function me(){const{response:e,error:r,loading:n,execute:a}=A("users/list",!1),{deletingUser:u,handleDeleteUser:m}=Z(),[i,d]=c.useState({limit:10,page:0}),[b,h]=c.useState(!0),[P,v]=c.useState(null),{language:{users:o}}=G(),{can:f}=H(),C=ee(),D=te(),R=c.useCallback(q(a,300),[]);c.useEffect(()=>{const t=re(i);R(`users/list?${N(t)}`);const l=p=>{p.origin===window.location.origin&&p.data.type==="USER_CHANGED"&&a(`users/list?${N(t)}`)};return window.addEventListener("message",l),()=>{window.removeEventListener("message",l)}},[i]);const T=t=>{const l=()=>{v(t)};return s.jsxs("div",{className:"actions-con",children:[f(J)&&s.jsx(w,{icon:"pi pi-pencil",rounded:!0,text:!0,onClick:()=>{l(),window.open(`/#/update-user?id=${t.id}`,"_blank","width=900,height=620")}}),f(X)&&s.jsx(w,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:p=>{l(),U(p,t)}})]})},U=(t,l)=>{Y({target:t.currentTarget,message:o.delete_confirm,icon:"pi pi-exclamation-triangle",acceptLabel:o.delete_yes,rejectLabel:o.delete_cancel,accept:async()=>{m(l,a)}})},F=(t,l)=>{d(p=>({...p,[l]:t.target.value}))},M=t=>{d(l=>({...l,limit:t.rows,page:t.page}))};return s.jsx("div",{className:"datatable-filter-demo p-toolbar header-justify-between footer-justify-between",children:s.jsxs(z,{value:e==null?void 0:e.data,loading:n||u,emptyMessage:()=>r?s.jsx(se,{setFilters:d}):o.no_records,scrollable:!0,selectionMode:"single",selection:P,onSelectionChange:t=>v(t.value),filterDisplay:b?"row":void 0,header:s.jsxs(s.Fragment,{children:[f(Q)&&s.jsx(w,{label:o.add_user,outlined:!0,icon:"pi pi-user-plus",onClick:()=>{window.open("/#/add-user","_blank","width=900,height=650")}}),s.jsx("div",{className:"show-filter-button-wrapper button-align-end",children:s.jsx(w,{icon:"pi pi-filter",severity:"secondary",text:!b,onClick:()=>h(t=>!t)})})]}),footer:s.jsx("div",{className:"table-footer",children:s.jsx(V,{className:"align-end",rows:i.limit,first:i.page*i.limit,totalRecords:e==null?void 0:e.meta.totalItems,onPageChange:t=>M(t),rowsPerPageOptions:[10,25,50,100],template:W()})}),children:[s.jsx(g,{showFilterMenu:!1,showClearButton:!1,field:"phoneNumber",header:o.phone,filter:!0,body:t=>s.jsx("span",{dir:"auto",children:t.phoneNumber||o.unknown}),filterElement:s.jsx(j,{label:"phoneNumber",filters:i,setFilters:d})}),s.jsx(g,{showFilterMenu:!1,showClearButton:!1,field:"username",header:o.username,filter:!0,body:t=>s.jsxs("div",{children:[t.username," ",s.jsx(S,{className:"inline-tag contrast-tag",severity:"info",value:t.role||o.unknown})]}),filterMatchModeOptions:[],filterElement:s.jsxs("div",{className:"space-filter",children:[s.jsx(j,{label:"username",filters:i,setFilters:d}),s.jsx(j,{label:"role",filters:i,setFilters:d})]})}),s.jsx(g,{showFilterMenu:!1,showClearButton:!1,field:"email",header:o.email,filter:!0,filterElement:s.jsx(j,{label:"email",filters:i,setFilters:d}),body:t=>t.email||o.unknown}),s.jsx(g,{showFilterMenu:!1,showClearButton:!1,field:"status",header:o.status,filter:!0,body:({status:t})=>{let l;switch(t){case"مفعل":l="contrast-tag";break;case"معلق":l="yellow-tag";break;default:l="red-tag"}return s.jsx(S,{className:l,value:C[t]||t||o.unknown})},filterElement:s.jsx(K,{value:i.status,options:D,onChange:t=>F(t,"status"),placeholder:o.search_by_status,className:"dropdown-filter-element"})}),s.jsx(g,{showFilterMenu:!1,showClearButton:!1,filter:!0,className:"actions-col",body:t=>T(t),filterElement:s.jsx("div",{className:"actions-filter"})})]})})}export{me as default};
