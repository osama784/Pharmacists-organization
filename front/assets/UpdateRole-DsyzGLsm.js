import{H as G,d as I,b as L,X as E,r as x,j as e,L as A,Y as D,x as H,_ as f,G as T,B as U}from"./index-XxLOGMNj.js";import{s as l,C as y}from"./roles.module-BWmjlUA7.js";import{F as M}from"./FailedRequest-hSUIgDhO.js";import{c as q}from"./roles-CBc3UJe5.js";function Q(){const[v]=G(),j=v.get("role")||"",{language:k}=I(),{roles:p}=k,{update_role_page:c}=p,{handleUpdateRole:$,loading:N}=q(`${j}`),{response:r,loading:C,execute:P,error:S}=L(`users/roles/get/${j}`),d=E(),[n,g]=x.useState(""),[m,i]=x.useState([]),b=x.useMemo(()=>Object.entries(d).flatMap(([s,t])=>Object.keys(t)),[]);x.useEffect(()=>{r&&(i(r.data.permissions),g(r.data.name))},[r]);const _=s=>{i(s?b:[])},w=(s,t)=>{const a=Object.keys(d[s]);i(t?o=>[...Array.from(new Set([...o,...a]))]:o=>o.filter(h=>!a.includes(h)))},F=s=>Object.keys(d[s]).map(a=>a).every(a=>m.includes(a)),R=b.every(s=>m.includes(s));return C?e.jsx(A,{}):S||!r?e.jsx("div",{className:"external-page-wra",children:e.jsx(M,{action:P})}):e.jsx("div",{className:"external-page-wra",children:e.jsxs("div",{className:"external-page",children:[e.jsxs("h2",{className:"header",children:[c.update_role,' "',r.data.name,'"']}),e.jsxs("div",{className:`${l.roleHeaderFields}`,children:[e.jsxs(D,{children:[e.jsx(H,{id:"role-name",value:n,onChange:s=>g(s.target.value),className:"full-width-input"}),e.jsx("label",{htmlFor:"role-name",children:c.role_name_label})]}),e.jsxs("div",{className:`${l.rolePermissionSwitcher}`,children:[e.jsx("label",{htmlFor:"toggle-all-permissions",children:c.all_permissions}),e.jsx(f,{inputId:"toggle-all-permissions",checked:R,onChange:s=>_(s.value)})]})]}),e.jsx("div",{className:`${l.permissionBoxesCon}`,children:Object.entries(d).map(([s,t])=>e.jsxs("div",{className:`${l.permissionBox}`,children:[e.jsxs("div",{className:`${l.rolePermissionSwitcher} ${l.permissionBoxHeader}`,children:[e.jsx("label",{htmlFor:`toggle-${s}-permissions`,children:p.permissionsKeys[s]||s}),e.jsx(f,{inputId:`toggle-${s}-permissions`,checked:F(s),onChange:a=>w(s,a.value)})]}),e.jsx("div",{className:`${l.permissionCheckBoxes}`,children:Object.entries(t).map(([a,o])=>{const h=`${s}-${a}`;return e.jsxs("div",{children:[e.jsx(y,{inputId:h,name:`${s}Permissions`,checked:m.includes(a),onChange:O=>{O.checked?i(u=>[...Array.from(new Set([...u,a]))]):i(u=>u.filter(B=>B!==a))}}),e.jsx("label",{htmlFor:h,className:"checkbox-label",children:o})]},a)})})]},s))}),e.jsx(T,{}),e.jsx("div",{className:"submit-area",children:e.jsx(U,{label:c.update_role,loading:N,onClick:()=>{$(n,m)},disabled:!(n!=null&&n.trim())})})]})})}export{Q as default};
