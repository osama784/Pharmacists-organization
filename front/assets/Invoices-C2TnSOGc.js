import{r as c,d as k,e as B,a3 as O,a4 as R,ak as T,b as A,f as L,al as V,g as x,j as t,D as b,aa as G,am as $,B as d,an as q,ao as Q,ap as X,k as H}from"./index-CAbGq19O.js";import{D as z,C as l,I as m,c as J,P as K,a as U}from"./Filters-BDT0_iG5.js";import{F as W}from"./FailedRequest-kw7mU4Mw.js";import{g as Y,a as Z}from"./invoices-Dmt9qTVN.js";function ie(){const[p,v]=c.useState(!0),[j,h]=c.useState(null),{language:{invoices:a}}=k(),{can:u}=B(),C=O(),g=R(e=>e.invoices.downloading),y=Y(),E=Z(),{deletingInvoice:I,handleDeleteInvoice:N}=T(),{response:o,error:F,loading:_,execute:f}=A("invoices/list",!1),[s,n]=c.useState({limit:10,page:0}),M=c.useCallback(L(f,300),[]);c.useEffect(()=>{const e=V(s);M(`invoices/list?${x(e)}`);const i=r=>{r.origin===window.location.origin&&r.data.type==="INVOICE_CHANGED"&&f(`invoices/list?${x(e)}`)};return window.addEventListener("message",i),()=>{window.removeEventListener("message",i)}},[s]);const w=(e,i)=>{n(r=>({...r,[i]:e.target.value}))},S=e=>{n(i=>({...i,limit:e.rows,page:e.page}))},D=e=>{const i=()=>{h(e)};return t.jsxs("div",{className:"actions-con",children:[t.jsx(d,{icon:"pi pi-pencil",rounded:!0,text:!0,onClick:()=>{i(),window.open(`/#/update-invoice?id=${e.id}`,"_blank","width=1000,height=620")}}),u(X)&&t.jsx(d,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:r=>{i(),P(r,e)}})]})},P=(e,i)=>{H({target:e.currentTarget,message:a.delete_confirm,icon:"pi pi-exclamation-triangle",acceptLabel:a.delete_yes,rejectLabel:a.delete_cancel,accept:async()=>{N(i,f)}})};return t.jsx("div",{className:"datatable-filter-demo p-toolbar header-justify-between footer-justify-between",children:t.jsxs(z,{value:o==null?void 0:o.data,loading:_||I,emptyMessage:()=>F?t.jsx(W,{setFilters:n}):a.no_records,scrollable:!0,selectionMode:"single",selection:j,onSelectionChange:e=>h(e.value),filterDisplay:p?"row":void 0,header:t.jsxs(t.Fragment,{children:[u(Q)&&t.jsx(d,{label:a.add_invoice,outlined:!0,icon:"pi pi-plus",onClick:()=>{window.open("/#/add-invoice","_blank","width=1000,height=650")}}),t.jsx("div",{className:"show-filter-button-wrapper button-align-end",children:t.jsx(d,{icon:"pi pi-filter",severity:"secondary",text:!p,onClick:()=>v(e=>!e)})})]}),footer:t.jsxs("div",{className:"table-footer",children:[u($)&&t.jsx(d,{label:a.export,loading:g,text:!0,severity:"secondary",onClick:()=>{g||C(q(s))}}),t.jsx(K,{className:"align-end",rows:s.limit,first:s.page*s.limit,totalRecords:o==null?void 0:o.meta.totalItems,onPageChange:e=>S(e),rowsPerPageOptions:[10,25,50,100],template:U()})]}),children:[t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"id",header:a.id,filter:!0,filterElement:t.jsx(m,{label:"id",filters:s,setFilters:n})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"pharmacist.fullName",header:a.pharmacist_full_name,filter:!0,filterElement:t.jsx(m,{label:"pharmacistFullName",filters:s,setFilters:n})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"pharmacist.nationalNumber",header:a.pharmacist_national_number,filter:!0,filterElement:t.jsx(m,{label:"pharmacistNationalNumber",filters:s,setFilters:n})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"syndicateMembership",header:a.syndicate_membership,filter:!0,filterElement:t.jsx(b,{value:s.syndicateMembership,options:E,onChange:e=>w(e,"syndicateMembership"),placeholder:a.select,className:"dropdown-filter-element"})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"createdAt",header:a.created_at,filter:!0,body:e=>G(e.createdAt),filterElement:t.jsx(J,{label:"createdAt",filters:s,setFilters:n})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"status",header:a.status,filter:!0,body:e=>e.status||a.unknown,filterElement:t.jsx(b,{value:s.status,options:y,onChange:e=>w(e,"status"),placeholder:a.select,className:"dropdown-filter-element"})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"total",header:a.total,filter:!1}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,filter:!0,className:"actions-col",body:e=>D(e),filterElement:t.jsx("div",{className:"actions-filter"})})]})})}export{ie as default};
