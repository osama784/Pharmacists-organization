import{r as c,d as P,a1 as k,a2 as B,ah as A,b as O,e as R,ai as T,f as w,j as t,D as x,a8 as L,B as d,aj as V,ak as G,al as $,am as q,W as Q}from"./index-Ba1r5UNg.js";import{u as H,D as U,C as l,I as W,c as z,P as J,a as K}from"./Filters-SNLJzrwl.js";import{F as X}from"./FailedRequest-C5Hseg6-.js";import{g as Y,a as Z}from"./invoices-gMRC5-ZX.js";import"./inputnumber.esm-B_oH-kEB.js";function ne(){const[m,v]=c.useState(!0),[b,f]=c.useState(null),{language:{invoices:s}}=P(),{can:u}=H(),j=k(),h=B(e=>e.invoices.downloading),y=Y(),C=Z(),{deletingInvoice:I,handleDeleteInvoice:E}=A(),{response:n,error:F,loading:N,execute:p}=O("invoices/list",!1),[i,r]=c.useState({limit:10,page:0}),D=c.useCallback(R(p,300),[]);c.useEffect(()=>{const e=T(i);D(`invoices/list?${w(e)}`);const a=o=>{o.origin===window.location.origin&&o.data.type==="INVOICE_CHANGED"&&p(`invoices/list?${w(e)}`)};return window.addEventListener("message",a),()=>{window.removeEventListener("message",a)}},[i]);const g=(e,a)=>{r(o=>({...o,[a]:e.target.value}))},S=e=>{r(a=>({...a,limit:e.rows,page:e.page}))},_=e=>{const a=()=>{f(e)};return t.jsxs("div",{className:"actions-con",children:[u($)&&t.jsx(d,{icon:"pi pi-pencil",rounded:!0,text:!0,onClick:()=>{a(),window.open(`/#/update-invoice?id=${e.id}`,"_blank","width=1000,height=620")}}),u(q)&&t.jsx(d,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:o=>{a(),M(o,e)}})]})},M=(e,a)=>{Q({target:e.currentTarget,message:s.delete_confirm,icon:"pi pi-exclamation-triangle",acceptLabel:s.delete_yes,rejectLabel:s.delete_cancel,accept:async()=>{E(a,p)}})};return t.jsx("div",{className:"datatable-filter-demo p-toolbar header-justify-between footer-justify-between",children:t.jsxs(U,{value:n==null?void 0:n.data,loading:N||I,emptyMessage:()=>F?t.jsx(X,{setFilters:r}):s.no_records,scrollable:!0,selectionMode:"single",selection:b,onSelectionChange:e=>f(e.value),filterDisplay:m?"row":void 0,header:t.jsxs(t.Fragment,{children:[u(G)&&t.jsx(d,{label:s.add_invoice,outlined:!0,icon:"pi pi-plus",onClick:()=>{window.open("/#/add-invoice","_blank","width=1000,height=650")}}),t.jsx("div",{className:"show-filter-button-wrapper button-align-end",children:t.jsx(d,{icon:"pi pi-filter",severity:"secondary",text:!m,onClick:()=>v(e=>!e)})})]}),footer:t.jsxs("div",{className:"table-footer",children:[t.jsx(d,{label:s.export,loading:h,text:!0,severity:"secondary",onClick:()=>{h||j(V(i))}}),t.jsx(J,{className:"align-end",rows:i.limit,first:i.page*i.limit,totalRecords:n==null?void 0:n.meta.totalItems,onPageChange:e=>S(e),rowsPerPageOptions:[10,25,50,100],template:K()})]}),children:[t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"pharmacist.fullName",header:s.pharmacist_full_name,filter:!0,filterElement:t.jsx(W,{label:"pharmacistFullName",filters:i,setFilters:r})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"syndicateMembership",header:s.syndicate_membership,filter:!0,filterElement:t.jsx(x,{value:i.syndicateMembership,options:C,onChange:e=>g(e,"syndicateMembership"),placeholder:s.select,className:"dropdown-filter-element"})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"createdAt",header:s.created_at,filter:!0,body:e=>L(e.createdAt),filterElement:t.jsx(z,{label:"createdAt",filters:i,setFilters:r})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"status",header:s.status,filter:!0,body:e=>e.status||s.unknown,filterElement:t.jsx(x,{value:i.status,options:y,onChange:e=>g(e,"status"),placeholder:s.select,className:"dropdown-filter-element"})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"total",header:s.total,filter:!1}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,filter:!0,className:"actions-col",body:e=>_(e),filterElement:t.jsx("div",{className:"actions-filter"})})]})})}export{ne as default};
