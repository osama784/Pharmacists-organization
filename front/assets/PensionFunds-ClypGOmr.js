import{r as i,d as v,a3 as C,a4 as E,e as y,b as R,f as S,aN as D,g as u,j as s,aO as N,B as O,aQ as _}from"./index-CAbGq19O.js";import{D as I,C as g,P as A,a as L,c as T}from"./Filters-BDT0_iG5.js";import{F as k}from"./FailedRequest-kw7mU4Mw.js";import{p as G}from"./accounting-B1riqVYz.js";function B(){const[p,m]=i.useState(null),{language:{accounting:r}}=v(),f=C(),d=E(e=>e.pensionFunds.downloading),{can:w}=y(),{response:o,error:x,loading:b,execute:c}=R("reports/invoices",!1),[t,l]=i.useState({limit:10,page:0,section:"خزانة التقاعد"}),P=i.useCallback(S(c,300),[]);i.useEffect(()=>{const e=D(t);P(`reports/invoices?${u(e)}`);const a=n=>{n.origin===window.location.origin&&n.data.type==="INVOICE_CHANGED"&&c(`pensionFunds/list?${u(e)}`)};return window.addEventListener("message",a),()=>{window.removeEventListener("message",a)}},[t]);const h=e=>{l(a=>({...a,limit:e.rows,page:e.page}))},j=(e,a)=>{if(!e)return 0;const n=e.find(F=>F.name===a);return n!=null&&n.value?n.value:r.unknown};return s.jsx("div",{className:"datatable-filter-demo p-toolbar header-justify-between footer-justify-between",children:s.jsxs(I,{value:o==null?void 0:o.data,loading:b,emptyMessage:()=>x?s.jsx(k,{setFilters:l}):r.no_records,scrollable:!0,selectionMode:"single",selection:p,onSelectionChange:e=>m(e.value),header:s.jsx(T,{label:"createdAt",filters:t,setFilters:l}),footer:s.jsxs("div",{className:"table-footer",children:[w(N)&&s.jsx(O,{label:r.export,loading:d,text:!0,severity:"secondary",onClick:()=>{d||f(_(t))}}),s.jsx(A,{className:"align-end",rows:t.limit,first:t.page*t.limit,totalRecords:o==null?void 0:o.meta.totalItems,onPageChange:e=>h(e),rowsPerPageOptions:[10,25,50,100],template:L()})]}),children:[s.jsx(g,{field:"receiptNumber",header:r.receipt_number}),G.map(e=>s.jsx(g,{header:e,body:a=>s.jsx("span",{children:j(a.fees,e)})},e))]})})}export{B as default};
