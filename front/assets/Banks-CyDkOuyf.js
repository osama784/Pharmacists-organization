import{b as E,r,d as P,e as S,f as _,g as f,j as t,aK as D,B as l,aL as F,aM as A,k as L}from"./index-CAbGq19O.js";import{D as T,C as m,I as M,P as K,a as R}from"./Filters-BDT0_iG5.js";import{F as G}from"./FailedRequest-kw7mU4Mw.js";import{u as I,g as $}from"./banks-Bntx6X2t.js";const q=["صندوق النقابة","خزانة التقاعد","صندوق إعانة العجز و الوفاة","خزانة التكافل الصحي"];function V(){const{response:n,error:h,loading:b,execute:c}=E("banks/list",!1),{handleDeleteBank:x,deletingBank:w}=I(),[i,d]=r.useState({limit:10,page:0}),[g,j]=r.useState(!0),[k,p]=r.useState(null),{language:{banks:s}}=P(),{can:u}=S(),y=r.useCallback(_(c,300),[]);r.useEffect(()=>{const e=$(i);y(`banks/list?${f(e)}`);const a=o=>{o.origin===window.location.origin&&o.data.type==="BANK_CHANGED"&&c(`banks/list?${f(e)}`)};return window.addEventListener("message",a),()=>{window.removeEventListener("message",a)}},[i]);const B=e=>{const a=()=>{p(e)};return t.jsxs("div",{className:"actions-con",children:[u(F)&&t.jsx(l,{icon:"pi pi-pencil",rounded:!0,text:!0,onClick:()=>{a(),window.open(`/#/update-bank?id=${e.id}`,"_blank","width=900,height=620")}}),u(A)&&t.jsx(l,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:o=>{a(),C(o,e)}})]})},C=(e,a)=>{L({target:e.currentTarget,message:s.delete_confirm,icon:"pi pi-exclamation-triangle",acceptLabel:s.delete_yes,rejectLabel:s.delete_cancel,accept:async()=>{x(a,c)}})},v=e=>{d(a=>({...a,limit:e.rows,page:e.page}))},N=(e,a)=>e.filter(o=>a===o.section)[0].accountNum;return t.jsx("div",{className:"datatable-filter-demo p-toolbar header-justify-between footer-justify-between",children:t.jsxs(T,{value:n==null?void 0:n.data,loading:b||w,emptyMessage:()=>h?t.jsx(G,{setFilters:d}):s.no_records,scrollable:!0,selectionMode:"single",selection:k,onSelectionChange:e=>p(e.value),filterDisplay:g?"row":void 0,header:t.jsxs(t.Fragment,{children:[u(D)&&t.jsx(l,{label:s.add_bank,outlined:!0,icon:"pi pi-plus",onClick:()=>{window.open("/#/add-bank","_blank","width=900,height=650")}}),t.jsx("div",{className:"show-filter-button-wrapper button-align-end",children:t.jsx(l,{icon:"pi pi-filter",severity:"secondary",text:!g,onClick:()=>j(e=>!e)})})]}),footer:t.jsx("div",{className:"table-footer",children:t.jsx(K,{className:"align-end",rows:i.limit,first:i.page*i.limit,totalRecords:n==null?void 0:n.meta.totalItems,onPageChange:e=>v(e),rowsPerPageOptions:[10,25,50,100],template:R()})}),children:[t.jsx(m,{showFilterMenu:!1,showClearButton:!1,field:"name",header:s.name,filter:!0,body:e=>t.jsx("span",{dir:"auto",children:e.name||s.unknown}),filterElement:t.jsx(M,{label:"name",filters:i,setFilters:d})}),q.map(e=>t.jsx(m,{header:e,body:a=>t.jsx("span",{children:N(a.accounts,e)})},e)),t.jsx(m,{showFilterMenu:!1,showClearButton:!1,filter:!0,className:"actions-col",body:e=>B(e),filterElement:t.jsx("div",{className:"actions-filter"})})]})})}export{V as default};
