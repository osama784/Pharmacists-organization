import{r as c,d as B,a1 as k,a2 as A,ah as O,b as R,e as T,ai as L,f as x,j as t,D as b,a8 as V,B as d,aj as G,ak as $,al as q,am as Q,W as H}from"./index-BEh_xnfq.js";import{u as U,D as W,C as l,I as f,c as z,P as J,a as K}from"./Filters-zWTrT3pY.js";import{F as X}from"./FailedRequest-B3co_hjT.js";import{g as Y,a as Z}from"./invoices-zzfpBmMT.js";import"./inputnumber.esm-BpHC9-a_.js";function le(){const[p,j]=c.useState(!0),[v,h]=c.useState(null),{language:{invoices:a}}=B(),{can:u}=U(),C=k(),g=A(e=>e.invoices.downloading),y=Y(),E=Z(),{deletingInvoice:I,handleDeleteInvoice:N}=O(),{response:o,error:F,loading:_,execute:m}=R("invoices/list",!1),[s,n]=c.useState({limit:10,page:0}),M=c.useCallback(T(m,300),[]);c.useEffect(()=>{const e=L(s);M(`invoices/list?${x(e)}`);const i=r=>{r.origin===window.location.origin&&r.data.type==="INVOICE_CHANGED"&&m(`invoices/list?${x(e)}`)};return window.addEventListener("message",i),()=>{window.removeEventListener("message",i)}},[s]);const w=(e,i)=>{n(r=>({...r,[i]:e.target.value}))},D=e=>{n(i=>({...i,limit:e.rows,page:e.page}))},S=e=>{const i=()=>{h(e)};return t.jsxs("div",{className:"actions-con",children:[u(q)&&t.jsx(d,{icon:"pi pi-pencil",rounded:!0,text:!0,onClick:()=>{i(),window.open(`/#/update-invoice?id=${e.id}`,"_blank","width=1000,height=620")}}),u(Q)&&t.jsx(d,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:r=>{i(),P(r,e)}})]})},P=(e,i)=>{H({target:e.currentTarget,message:a.delete_confirm,icon:"pi pi-exclamation-triangle",acceptLabel:a.delete_yes,rejectLabel:a.delete_cancel,accept:async()=>{N(i,m)}})};return t.jsx("div",{className:"datatable-filter-demo p-toolbar header-justify-between footer-justify-between",children:t.jsxs(W,{value:o==null?void 0:o.data,loading:_||I,emptyMessage:()=>F?t.jsx(X,{setFilters:n}):a.no_records,scrollable:!0,selectionMode:"single",selection:v,onSelectionChange:e=>h(e.value),filterDisplay:p?"row":void 0,header:t.jsxs(t.Fragment,{children:[u($)&&t.jsx(d,{label:a.add_invoice,outlined:!0,icon:"pi pi-plus",onClick:()=>{window.open("/#/add-invoice","_blank","width=1000,height=650")}}),t.jsx("div",{className:"show-filter-button-wrapper button-align-end",children:t.jsx(d,{icon:"pi pi-filter",severity:"secondary",text:!p,onClick:()=>j(e=>!e)})})]}),footer:t.jsxs("div",{className:"table-footer",children:[t.jsx(d,{label:a.export,loading:g,text:!0,severity:"secondary",onClick:()=>{g||C(G(s))}}),t.jsx(J,{className:"align-end",rows:s.limit,first:s.page*s.limit,totalRecords:o==null?void 0:o.meta.totalItems,onPageChange:e=>D(e),rowsPerPageOptions:[10,25,50,100],template:K()})]}),children:[t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"id",header:a.id,filter:!0,filterElement:t.jsx(f,{label:"id",filters:s,setFilters:n})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"pharmacist.fullName",header:a.pharmacist_full_name,filter:!0,filterElement:t.jsx(f,{label:"pharmacistFullName",filters:s,setFilters:n})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"pharmacist.nationalNumber",header:a.pharmacist_national_number,filter:!0,filterElement:t.jsx(f,{label:"pharmacistNationalNumber",filters:s,setFilters:n})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"syndicateMembership",header:a.syndicate_membership,filter:!0,filterElement:t.jsx(b,{value:s.syndicateMembership,options:E,onChange:e=>w(e,"syndicateMembership"),placeholder:a.select,className:"dropdown-filter-element"})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"createdAt",header:a.created_at,filter:!0,body:e=>V(e.createdAt),filterElement:t.jsx(z,{label:"createdAt",filters:s,setFilters:n})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"status",header:a.status,filter:!0,body:e=>e.status||a.unknown,filterElement:t.jsx(b,{value:s.status,options:y,onChange:e=>w(e,"status"),placeholder:a.select,className:"dropdown-filter-element"})}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,field:"total",header:a.total,filter:!1}),t.jsx(l,{showFilterMenu:!1,showClearButton:!1,filter:!0,className:"actions-col",body:e=>S(e),filterElement:t.jsx("div",{className:"actions-filter"})})]})})}export{le as default};
