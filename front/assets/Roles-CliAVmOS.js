import{b as P,r as n,d as S,e as k,f as F,g as f,j as e,X as N,B as r,Y as T,_ as O,k as M}from"./index-CAbGq19O.js";import{D as $,C as h,I as A,P as G,a as I}from"./Filters-BDT0_iG5.js";import{F as U}from"./FailedRequest-kw7mU4Mw.js";import{a as q}from"./roles-Cdw7N9oq.js";function Y(){var g;const{response:o,loading:x,error:w,execute:c}=P("users/roles/list",!1),{deletingRole:b,handleDeleteRole:j}=q(),[m,E]=n.useState(!0),[y,p]=n.useState(null),[a,d]=n.useState({limit:10,page:0}),{language:v}=S(),{roles:i}=v,{can:u}=k(),R=n.useCallback(F(c,300),[]);n.useEffect(()=>{const t={pagination:{limit:a.limit,page:a.page},filters:[{path:"name",value:a.name,operator:"$regex"}]};R(`users/roles/list?${f(t)}`);const s=l=>{l.origin===window.location.origin&&l.data.type==="ROLE_CHANGED"&&c(`users/roles/list?${f(t)}`)};return window.addEventListener("message",s),()=>{window.removeEventListener("message",s)}},[a]);const _=t=>{d(s=>({...s,limit:t.rows,page:t.page}))},C=t=>{const s=()=>{p(t)},l=()=>{window.open(`/#/update-role?role=${t.id}`,"_blank","width=900,height=650")};return e.jsxs("div",{className:"actions-con",children:[u(T)&&e.jsx(r,{icon:"pi pi-pencil",rounded:!0,text:!0,onClick:()=>{s(),l()}}),u(O)&&e.jsx(r,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:L=>{s(),D(L,t)}})]})},D=(t,s)=>{M({target:t.currentTarget,message:i.delete_confirm,icon:"pi pi-exclamation-triangle",acceptLabel:i.delete_yes,rejectLabel:i.delete_cancel,accept:async()=>{j(s,c)}})};return e.jsx("div",{className:"datatable-filter-demo p-toolbar header-justify-between footer-justify-between",children:e.jsxs($,{value:o==null?void 0:o.data,loading:x||b,emptyMessage:()=>w?e.jsx(U,{setFilters:d}):i.no_records,scrollable:!0,selectionMode:"single",selection:y,onSelectionChange:t=>p(t.value),filterDisplay:m?"row":void 0,header:e.jsxs(e.Fragment,{children:[u(N)&&e.jsx(r,{label:i.add_role,outlined:!0,icon:"pi pi-plus",onClick:()=>window.open("/#/add-role","_blank","width=900,height=650")}),e.jsx("div",{className:"show-filter-button-wrapper button-align-end",children:e.jsx(r,{icon:"pi pi-filter",severity:"secondary",text:!m,onClick:()=>E(t=>!t)})})]}),footer:e.jsx("div",{className:"table-footer",children:e.jsx(G,{className:"align-end",rows:a.limit,first:a.page*a.limit,totalRecords:(g=o==null?void 0:o.meta)==null?void 0:g.totalItems,onPageChange:_,rowsPerPageOptions:[10,25,50,100],template:I()})}),children:[e.jsx(h,{field:"name",header:i.name,filter:!0,showFilterMenu:!1,filterElement:e.jsx(A,{label:"name",filters:a,setFilters:d})}),e.jsx(h,{className:"actions-col",body:C})]})})}export{Y as default};
